<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SammyDoo - Jump & Catch!</title>

<style>
body {
  background: #222;
  color: #fff;
  font-family: Arial, sans-serif;
  margin: 0;
  text-align: center;
  overflow: hidden;
}

#gameContainer {
  max-width: 800px;
  margin: auto;
  position: relative;
}

canvas {
  background: #87CEEB;
  width: 100%;
  aspect-ratio: 4 / 3;
}

#ui {
  display: flex;
  justify-content: space-between;
  padding: 5px;
  font-size: 18px;
}

.badge {
  background: rgba(0,0,0,0.6);
  padding: 6px 10px;
  border-radius: 6px;
}

.floatingText {
  position: absolute;
  pointer-events: none;
  color: yellow;
  font-weight: bold;
  animation: floatUp 1s forwards;
}

@keyframes floatUp {
  from { opacity:1; transform: translateY(0); }
  to { opacity:0; transform: translateY(-40px); }
}
</style>
</head>

<body>
<div id="gameContainer">
<h1>üê∂ SammyDoo Jump & Catch</h1>
<canvas id="gameCanvas"></canvas>

<div id="ui">
  <div id="score" class="badge">Score: 0</div>
  <div id="timer" class="badge">Time: 120</div>
  <div id="highScore" class="badge">High Score: 0</div>
</div>
</div>

<script>
/* =====================================================
   BASIC SETUP
===================================================== */
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

function resize() {
  canvas.width = Math.min(window.innerWidth, 800);
  canvas.height = canvas.width * 0.75;
}
resize();
window.addEventListener('resize', resize);

/* =====================================================
   GAME STATE
===================================================== */
let score = 0;
let highScore = +localStorage.getItem('sammyHigh') || 0;
let timeLeft = 120;
let lastTime = performance.now();
let shakeTime = 0;

/* =====================================================
   PLAYER
===================================================== */
const playerW = 80;
const playerH = 80;
let playerX = canvas.width / 2;
let playerY = canvas.height - playerH;

let jumpVelocity = 0;
let playerJumping = false;

const gravity = 2400;
const jumpPower = -1200;

// jump forgiveness
let coyoteTime = 0;
let jumpBuffer = 0;
const COYOTE = 0.12;
const JUMP_BUFFER = 0.15;

/* =====================================================
   INPUT
===================================================== */
const keys = { left:false, right:false };
let touchLeft = false;
let touchRight = false;

// keyboard
document.addEventListener('keydown', e => {
  if (e.key === 'ArrowLeft') keys.left = true;
  if (e.key === 'ArrowRight') keys.right = true;
  if (e.code === 'Space') jumpBuffer = JUMP_BUFFER;
});
document.addEventListener('keyup', e => {
  if (e.key === 'ArrowLeft') keys.left = false;
  if (e.key === 'ArrowRight') keys.right = false;
});

// simplified touch (canvas)
canvas.addEventListener('touchstart', e => {
  const x = e.touches[0].clientX;
  if (x < window.innerWidth / 2) touchLeft = true;
  else touchRight = true;
  jumpBuffer = JUMP_BUFFER;
});
canvas.addEventListener('touchend', () => {
  touchLeft = false;
  touchRight = false;
});

/* =====================================================
   IMAGES
===================================================== */
const images = {};
function load(src) {
  const i = new Image();
  i.src = src;
  return i;
}

images.bg = load('park.png');
images.run1 = load('sam_run1.png');
images.run2 = load('sam_run2.png');
images.jump = load('sam_jump.png');

const objectTypes = [
  {name:'Frisbee', img:load('frisbee.png'), pts:10, size:40, speed:220},
  {name:'Ball', img:load('ball.png'), pts:8, size:30, speed:250},
  {name:'Stick', img:load('stick.png'), pts:5, size:45, speed:200},
  {name:'Star', img:load('star.png'), special:'x2', size:40, speed:240},
  {name:'Bone', img:load('bone.png'), special:'time', size:40, speed:240}
];

/* =====================================================
   ITEMS
===================================================== */
let items = [];
let spawnRate = 1.8;

/* power up */
let multiplier = 1;
let multiplierTimer = 0;

/* =====================================================
   UTILS
===================================================== */
function floatingText(text, x, y) {
  const el = document.createElement('div');
  el.className = 'floatingText';
  el.style.left = x + 'px';
  el.style.top = y + 'px';
  el.textContent = text;
  document.body.appendChild(el);
  setTimeout(() => el.remove(), 1000);
}

/* =====================================================
   GAME LOOP
===================================================== */
function update(dt) {

  spawnRate += dt * 0.02;

  // movement
  if (keys.left || touchLeft) playerX -= 400 * dt;
  if (keys.right || touchRight) playerX += 400 * dt;
  playerX = Math.max(playerW/2, Math.min(canvas.width-playerW/2, playerX));

  // jump
  if (!playerJumping) coyoteTime -= dt;
  if (jumpBuffer > 0 && coyoteTime > 0 && !playerJumping) {
    playerJumping = true;
    jumpVelocity = jumpPower;
    jumpBuffer = 0;
    coyoteTime = 0;
  }

  if (playerJumping) {
    jumpVelocity += gravity * dt;
    playerY += jumpVelocity * dt;
    if (playerY >= canvas.height - playerH) {
      playerY = canvas.height - playerH;
      playerJumping = false;
      jumpVelocity = 0;
      coyoteTime = COYOTE;
    }
  }

  if (jumpBuffer > 0) jumpBuffer -= dt;

  // items spawn
  if (Math.random() < spawnRate * dt && items.length < 6) {
    const t = objectTypes[Math.floor(Math.random()*objectTypes.length)];
    items.push({t, x:Math.random()*(canvas.width-40)+20, y:-40});
  }

  items.forEach(o => {
    o.y += (o.t.speed + spawnRate*10) * dt;

    if (Math.abs(o.x-playerX)<50 && Math.abs(o.y-(playerY+40))<50 && playerJumping) {
      if (o.t.special === 'x2') {
        multiplier = 2;
        multiplierTimer = 5;
        floatingText('x2!', o.x, o.y);
      } else if (o.t.special === 'time') {
        timeLeft += 5;
        floatingText('+5s', o.x, o.y);
      } else {
        score += o.t.pts * multiplier;
        floatingText('+'+(o.t.pts*multiplier), o.x, o.y);
      }
      shakeTime = 0.15;
      o.dead = true;
    }
  });

  items = items.filter(o => !o.dead && o.y < canvas.height+50);

  if (multiplierTimer > 0) {
    multiplierTimer -= dt;
    if (multiplierTimer <= 0) multiplier = 1;
  }
}

function draw() {
  ctx.save();
  if (shakeTime > 0) {
    ctx.translate(Math.random()*6-3, Math.random()*6-3);
    shakeTime -= 0.016;
  }

  ctx.drawImage(images.bg, 0, 0, canvas.width, canvas.height);

  // player
  const img = playerJumping ? images.jump : images.run1;
  ctx.drawImage(img, playerX-playerW/2, playerY, playerW, playerH);

  // items
  items.forEach(o => ctx.drawImage(o.t.img, o.x-20, o.y-20, 40, 40));

  ctx.restore();
}

function loop(t) {
  const dt = Math.min((t-lastTime)/1000,0.05);
  lastTime = t;

  update(dt);
  draw();

  document.getElementById('score').textContent = 'Score: ' + score;
  document.getElementById('timer').textContent = 'Time: ' + timeLeft;
  document.getElementById('highScore').textContent = 'High Score: ' + highScore;

  requestAnimationFrame(loop);
}

setInterval(()=>{
  timeLeft--;
  if (timeLeft <= 0) {
    if (score > highScore) {
      highScore = score;
      localStorage.setItem('sammyHigh', highScore);
    }
    location.reload();
  }
},1000);

requestAnimationFrame(loop);
</script>
</body>
</html>

